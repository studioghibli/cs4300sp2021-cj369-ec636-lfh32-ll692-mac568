<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <title>Game Recommendations</title>
  <link rel="stylesheet" href="/static/bootstrap.min.css">
  <link rel="stylesheet" href="/static/main.css">
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
  <style>
  
  </style>
</head>

<body>
  <div class="topcorner">
    <a href="account" class="btn btn-warning">Sign In</a>
  </div>

  <div class="navbar navbar-default navbar-fixed-bottom" role="navigation">
    <nav>
      <ul class="nav navbar-nav">
        <li>
          <a href="/">Search</a>
        </li>
        <li>
          <a href="popular">Popular</a>
        </li>
        <li>
          <a href="videogames">Video Games</a>
        </li>
        <li>
          <a href="mobilegames">Mobile Games</a>
        </li>
        <li>
          <a href="boardgames">Board Games</a>
        </li>
      </ul>
    </nav>
    <div class="container">
      <p class="navbar-text pull-right">Built by: cj369, ec636, lfh32, ll692, mac568</p>
    </div>
  </div>

  <h1 style="font-size: 55px; font-family:Futura; color: #4285F4; text-align:center">
    C
    <span style="color: #EA4335; ">S</span>
    <span style="color: #FBBC05; ">4</span>
    3
    <span style="color: #34A853; ">0</span>
    <span style="color: #EA4335; ">0</span>
  </h1>
  <h2 style="text-align:center">Game Recommendation Engine</h2>


  <h3 style="text-align:center">{{output_message}}</h3>


  <form class="form-inline global-search">
    <div class="form-group" style="text-align:center">
      <label id='typelabel' for="gametype">Type of game:</label>
      <br>
      <select id="gametype" name="gametype" class="form-control">
        <option value="Board Games">Board Game</option>
        <option value="Mobile Games">Mobile Game</option>
        <option value="Video Games">Video Game</option>
      </select>
   
      <br>
      <input list="input_game" id= 'gn' name="gn" class="form-control" placeholder="Enter a game to start" />
      <datalist id="input_game" style="font-family: Helvetica Neue; font-style: normal;">
        <option id ='op0' value="1">
        <option id = 'op1' value="2">
        <option id = 'op2' value="3">
        <option id = 'op3' value="4">
        <option id = 'op4' value="5">
        <option id = 'op5' value="6">
        <option id = 'op6' value="7">
        <option id = 'op7' value="8">
        <option id = 'op8' value="9">
        <option id = 'op9' value="10">
      </datalist>


      <button id='go' type="submit" class="btn btn-info"> Go! </button>
    </div>

  </form>

  <div class="container-fluid results">
    <form class="form-inline global-search">
      {%if data != None%}
      {% for d in data %}

      <div class="row">
        <div class="col-sm-4" style="padding: 5px;">
          <div class="result-box" style="display:block; height: 160px; padding: 50px 0; border-style: solid">
            <div class="result-box-caption">
              <div class="result-box-caption-content">
                <div class="result-text">
                  <p>
                    <strong>
                      {%if gt == 'Video Games'%}
                      {{d[1]}}
                      {%else%}
                      {{d[0]}}
                      {% endif %}
                    </strong>
                </p>
                </div>
                <br>
                <br>
                <div class="result-expand">
                  <p>Click here for more info</p>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

      {% endfor %}

      {% endif %}
    </form>
  </div>

  <br>
  <br>

  <script>
    var prev;

    function edDist(gn){
      var res = $.ajax({
        type: "POST",
        
        url: "/app/irsystem/controllers/search_controller.py",
        data:{param: gn},
        success: hallelujah
      });
      prev = res;
      return res;
    }

    function hallelujah(response) {
        // do something with the response
        console.log(response);
      }

      let gn = d3.select('#gn');

      gn.on('input', function(){
        if ( document.getElementById('gn').value === null || prev === document.getElementById('gn').value){
          return;
        }
  
        let ans = edDist(document.getElementById('gn').value);
        for (let i = 0; i < ans.length; i++){
          document.getElementById('op' + toString(i)).value = ans[i];
        }
      })

  </script>

  </html>